<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PORTFOLIO | WEIYU ZHANG</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="main.css"> 
</head>
<body class="anim-mode is-loading">
    
    <div id="header-mask"></div>

    <nav id="top-categories">
        <a href="#" class="category-item" data-category="architecture">ARCHITECTURE</a>
        <a href="#" class="category-item" data-category="competition">COMPETITION</a>
        <a href="#" class="category-item" data-category="hchx">HCI&HX</a>
    </nav>
    
    <div id="left-menu-container">
        <div id="menu-toggle">
            <span id="name-logo">WEIYU ZHANG</span>
            <div id="hamburger-icon" class="hidden">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
        </div>
        <nav id="dropdown-menu">
            <ul>
                <li><a href="#" data-internal>WORK</a></li>
                <li><a href="#" data-internal>ABOUT</a></li>
                <li><a href="#" data-internal>CONTACT</a></li>
            </ul>
        </nav>
    </div>

    <div id="scroll-wrapper"> 
        
        <main id="portfolio-grid">
            
            <a href="project1.html" class="project-item" data-internal data-category="competition">
                <div class="project-info">
                    <h4>Life By The Wall</h4>
                    <p>UIA Competition 2025</p>
                </div>
                <div class="project-media placeholder" style="background-image: url('pj1.png');">
                </div>
            </a>
            
            <a href="project2.html" class="project-item" data-internal data-category="architecture">
                <div class="project-info">
                    <h4>Memory Museum</h4>
                    <p>Design Course 2025</p>
                </div>
                <div class="project-media placeholder"></div>
            </a>
            
            <a href="#" class="project-item" data-internal data-category="architecture">
                <div class="project-info">
                    <h4>Bloomberg Student Center at Johns Hopkins University</h4>
                    <p>BALTIMORE, UNITED STATES</p>
                </div>
                <div class="project-media placeholder"></div>
            </a>
            
            <a href="#" class="project-item" data-internal data-category="hchx">
                <div class="project-info">
                    <h4>Digital Twin Interactive Model</h4>
                    <p>TJU CAUP Research</p>
                </div>
                <div class="project-media placeholder"></div>
            </a>
            
        </main>
    </div> 
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const categoryItems = document.querySelectorAll('#top-categories .category-item');
            const projectItems = document.querySelectorAll('#portfolio-grid .project-item');
            let activeFilter = null; 
            const TRANSITION_TIME = 800; 

            // --- 1. 滚动阻尼逻辑 ---
            const scrollWrapper = document.getElementById('scroll-wrapper');
            let currentScrollY = 0; 
            let targetScrollY = 0;  
            const dampingFactor = 0.1; 
            const scrollSpeed = 1; 

            const getMaxScroll = () => scrollWrapper.scrollHeight - window.innerHeight;

            function animateScroll() {
                currentScrollY += (targetScrollY - currentScrollY) * dampingFactor;
                currentScrollY = Math.max(0, Math.min(currentScrollY, getMaxScroll()));
                scrollWrapper.style.transform = `translateY(-${currentScrollY}px)`;
                requestAnimationFrame(animateScroll);
            }

            window.addEventListener('wheel', (e) => {
                targetScrollY += e.deltaY * scrollSpeed;
                targetScrollY = Math.max(0, Math.min(targetScrollY, getMaxScroll()));
            });

            animateScroll();

            // --- 2. 页面加载动画 (淡入) ---
            setTimeout(() => {
                body.classList.remove('is-loading');
            }, 50);

            // --- 3. 筛选核心逻辑 ---
            categoryItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const filterCategory = item.getAttribute('data-category');

                    if (activeFilter === filterCategory) {
                        item.classList.remove('active');
                        activeFilter = null;
                    } else {
                        categoryItems.forEach(i => i.classList.remove('active'));
                        item.classList.add('active');
                        activeFilter = filterCategory;
                    }
                    filterProjects(activeFilter);
                });
            });

            function filterProjects(filter) {
                projectItems.forEach(project => {
                    const projectCategory = project.getAttribute('data-category');
                    project.classList.remove('filtered');
                    if (filter && projectCategory !== filter) {
                        setTimeout(() => {
                            project.classList.add('filtered');
                        }, 50); 
                    } else {
                        project.classList.remove('filtered');
                    }
                });
            }


            // --- 4. 页面离开动画 (淡出) ---
            document.querySelectorAll('a[data-internal]').forEach(link => {
                link.addEventListener('click', (e) => {
                    const targetUrl = link.href;
                    if (targetUrl && !targetUrl.endsWith('#')) {
                        e.preventDefault();
                        projectItems.forEach(p => p.style.height = '0'); 
                        body.classList.add('is-leaving');
                        setTimeout(() => {
                            window.location.href = targetUrl;
                        }, TRANSITION_TIME);
                    }
                });
            });


            // --- 5. 菜单逻辑 (保持不变) ---
            const leftMenuContainer = document.getElementById('left-menu-container');
            const menuToggle = document.getElementById('menu-toggle');
            const nameLogo = document.getElementById('name-logo');
            const hamburgerIcon = document.getElementById('hamburger-icon');
            const dropdownMenu = document.getElementById('dropdown-menu');
            let menuIsActive = false; 

            menuToggle.addEventListener('mouseenter', () => {
                if (menuIsActive) return; 
                nameLogo.style.transform = 'translateY(-100%)';
                setTimeout(() => {
                    nameLogo.classList.add('hidden');
                    hamburgerIcon.classList.remove('hidden');
                    hamburgerIcon.style.opacity = '1';
                }, 300);
            });

            menuToggle.addEventListener('mouseleave', () => {
                if (menuIsActive) return; 
                hamburgerIcon.style.opacity = '0';
                setTimeout(() => {
                    hamburgerIcon.classList.add('hidden');
                    nameLogo.classList.remove('hidden');
                    nameLogo.style.transform = 'translateY(0)';
                }, 300);
            });

            menuToggle.addEventListener('click', (event) => {
                event.stopPropagation(); 
                if (!menuIsActive) {
                    dropdownMenu.style.visibility = 'visible';
                    dropdownMenu.style.opacity = '1';
                    dropdownMenu.style.maxHeight = '200px'; 
                    menuIsActive = true;
                    nameLogo.classList.add('hidden');
                    nameLogo.style.transform = 'translateY(100%)'; 
                    hamburgerIcon.classList.remove('hidden');
                    hamburgerIcon.style.opacity = '1';
                } else {
                    closeMenu();
                }
            });

            document.addEventListener('click', (event) => {
                if (menuIsActive && !leftMenuContainer.contains(event.target)) {
                    closeMenu();
                }
            });

            function closeMenu() {
                dropdownMenu.style.opacity = '0';
                dropdownMenu.style.maxHeight = '0';
                menuIsActive = false;
                setTimeout(() => {
                    dropdownMenu.style.visibility = 'hidden';
                    hamburgerIcon.style.opacity = '0';
                    hamburgerIcon.classList.add('hidden');
                    nameLogo.classList.remove('hidden');
                    nameLogo.style.transform = 'translateY(0)';
                }, 400); 
            }
        });
    </script>
</body>
</html>